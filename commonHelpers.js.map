{"version":3,"file":"commonHelpers.js","sources":["../src/main.js"],"sourcesContent":["'use strict';\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\n\nimport axios from 'axios';\n\nconst form = document.querySelector('form');\nconst gallery = document.querySelector('.gallery');\nconst spinner = document.querySelector('.loader');\nconst fetchBtn = document.querySelector('.loadBtn');\n\nlet page = 1;\nlet limit = 15;\nconst totalPages = Math.ceil(500 / limit);\n\nconst lightbox = new SimpleLightbox('.gallery a', {\n  captionsData: 'alt',\n  captionDelay: 250,\n});\n\nconst paramsAPI = {\n  key: '42045393-d503a5a54b8da83761f9aabf4',\n  q: '',\n  image_type: 'photo',\n  orientation: 'horizontal',\n  safesearch: true,\n  page: page,\n  per_page: limit,\n};\n\nfunction renderGalleryImg(arr) {\n  const markup = arr\n    .map(\n      ({\n        webformatURL,\n        largeImageURL,\n        tags,\n        likes,\n        views,\n        comments,\n        downloads,\n      }) => {\n        return `<li class=\"gallery-item\">\n  <a class=\"gallery-link\" href=\"${largeImageURL}\">\n    <img\n      class=\"gallery-image\"\n      src=\"${webformatURL}\"\n      data-source=\"\"\n      alt=\"${tags}\"\n    />\n\t\t\n  </a>\n  <ul class=\"image-info\">\n    <li class=\"info-item\">\n    <p>Likes</p>\n    ${likes}\n    </li>\n    <li class=\"info-item\"><p>Views</p>\n    ${views}\n    </li>\n    <li class=\"info-item\">\n    <p>Comments</p>\n    ${comments}\n    </li>\n    <li class=\"info-item\"><p>Downloads</p>\n    ${downloads}\n    </li>\n  </ul> \n\t\n</li>`;\n      }\n    )\n    .join('');\n\n  gallery.insertAdjacentHTML('beforeend', markup);\n  document.querySelector('.gallery-link').addEventListener('click', e => {\n    e.preventDefault();\n  });\n\n  console.log(document.querySelector('.gallery-item').getBoundingClientRect());\n  lightbox.refresh();\n}\n\nfunction getFormValueStr(str) {\n  paramsAPI.q = str.replace(/\\\\s+/g, '+');\n\n  fetchImages()\n    .then(img => {\n      gallery.innerHTML = '';\n      spinnerToggleShow();\n      fetchBtn.style.display = 'block';\n\n      if (img.hits.length !== 0) {\n        renderGalleryImg(img.hits);\n      } else {\n        iziToast.error({\n          position: 'topRight',\n          message:\n            'Sorry, there are no images matching your search query. Please try again!',\n        });\n      }\n    })\n    .catch(error => console.log('Error:', error));\n}\n\nfetchBtn.addEventListener('click', async () => {\n  spinnerToggleShow();\n  if (paramsAPI.page > totalPages) {\n    fetchBtn.style.display = 'none';\n    return iziToast.info({\n      position: 'topRight',\n      message: \"We're sorry, but you've reached the end of search results.\",\n    });\n  }\n\n  page += 1;\n  paramsAPI.page = page;\n\n  console.log(paramsAPI.page);\n\n  await fetchImages()\n    .then(img => {\n      spinnerToggleShow();\n      renderGalleryImg(img.hits);\n      window.scrollBy({\n        left: 0,\n        top: 515,\n        behavior: 'smooth',\n      });\n    })\n    .catch(error => console.log('Error:', error));\n});\n\nform.addEventListener('submit', e => {\n  e.preventDefault();\n\n  if (e.target.elements.search.value !== '') {\n    spinnerToggleShow();\n\n    getFormValueStr(e.target.elements.search.value);\n  }\n});\n\nasync function fetchImages() {\n  const searchParams = new URLSearchParams(paramsAPI);\n  const response = await axios.get(`https://pixabay.com/api?${searchParams}`);\n\n  return response.data;\n}\n\nfunction spinnerToggleShow() {\n  spinner.classList.toggle('loader_show');\n}\n"],"names":["form","gallery","spinner","fetchBtn","page","limit","totalPages","lightbox","SimpleLightbox","paramsAPI","renderGalleryImg","arr","markup","webformatURL","largeImageURL","tags","likes","views","comments","downloads","e","getFormValueStr","str","fetchImages","img","spinnerToggleShow","iziToast","error","searchParams","axios"],"mappings":"owBAQA,MAAMA,EAAO,SAAS,cAAc,MAAM,EACpCC,EAAU,SAAS,cAAc,UAAU,EAC3CC,EAAU,SAAS,cAAc,SAAS,EAC1CC,EAAW,SAAS,cAAc,UAAU,EAElD,IAAIC,EAAO,EACPC,EAAQ,GACZ,MAAMC,EAAa,KAAK,KAAK,IAAMD,CAAK,EAElCE,EAAW,IAAIC,EAAe,aAAc,CAChD,aAAc,MACd,aAAc,GAChB,CAAC,EAEKC,EAAY,CAChB,IAAK,qCACL,EAAG,GACH,WAAY,QACZ,YAAa,aACb,WAAY,GACZ,KAAML,EACN,SAAUC,CACZ,EAEA,SAASK,EAAiBC,EAAK,CAC7B,MAAMC,EAASD,EACZ,IACC,CAAC,CACC,aAAAE,EACA,cAAAC,EACA,KAAAC,EACA,MAAAC,EACA,MAAAC,EACA,SAAAC,EACA,UAAAC,CACR,IACe;AAAA,kCACmBL;AAAA;AAAA;AAAA,aAGrBD;AAAA;AAAA,aAEAE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAOPC;AAAA;AAAA;AAAA,MAGAC;AAAA;AAAA;AAAA;AAAA,MAIAC;AAAA;AAAA;AAAA,MAGAC;AAAA;AAAA;AAAA;AAAA,MAMD,EACA,KAAK,EAAE,EAEVlB,EAAQ,mBAAmB,YAAaW,CAAM,EAC9C,SAAS,cAAc,eAAe,EAAE,iBAAiB,QAASQ,GAAK,CACrEA,EAAE,eAAc,CACpB,CAAG,EAED,QAAQ,IAAI,SAAS,cAAc,eAAe,EAAE,sBAAqB,CAAE,EAC3Eb,EAAS,QAAO,CAClB,CAEA,SAASc,EAAgBC,EAAK,CAC5Bb,EAAU,EAAIa,EAAI,QAAQ,QAAS,GAAG,EAEtCC,EAAa,EACV,KAAKC,GAAO,CACXvB,EAAQ,UAAY,GACpBwB,IACAtB,EAAS,MAAM,QAAU,QAErBqB,EAAI,KAAK,SAAW,EACtBd,EAAiBc,EAAI,IAAI,EAEzBE,EAAS,MAAM,CACb,SAAU,WACV,QACE,0EACZ,CAAS,CAET,CAAK,EACA,MAAMC,GAAS,QAAQ,IAAI,SAAUA,CAAK,CAAC,CAChD,CAEAxB,EAAS,iBAAiB,QAAS,SAAY,CAE7C,GADAsB,IACIhB,EAAU,KAAOH,EACnB,OAAAH,EAAS,MAAM,QAAU,OAClBuB,EAAS,KAAK,CACnB,SAAU,WACV,QAAS,4DACf,CAAK,EAGHtB,GAAQ,EACRK,EAAU,KAAOL,EAEjB,QAAQ,IAAIK,EAAU,IAAI,EAE1B,MAAMc,EAAa,EAChB,KAAKC,GAAO,CACXC,IACAf,EAAiBc,EAAI,IAAI,EACzB,OAAO,SAAS,CACd,KAAM,EACN,IAAK,IACL,SAAU,QAClB,CAAO,CACP,CAAK,EACA,MAAMG,GAAS,QAAQ,IAAI,SAAUA,CAAK,CAAC,CAChD,CAAC,EAED3B,EAAK,iBAAiB,SAAUoB,GAAK,CACnCA,EAAE,eAAc,EAEZA,EAAE,OAAO,SAAS,OAAO,QAAU,KACrCK,IAEAJ,EAAgBD,EAAE,OAAO,SAAS,OAAO,KAAK,EAElD,CAAC,EAED,eAAeG,GAAc,CAC3B,MAAMK,EAAe,IAAI,gBAAgBnB,CAAS,EAGlD,OAFiB,MAAMoB,EAAM,IAAI,2BAA2BD,GAAc,GAE1D,IAClB,CAEA,SAASH,GAAoB,CAC3BvB,EAAQ,UAAU,OAAO,aAAa,CACxC"}